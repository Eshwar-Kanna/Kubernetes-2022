

                                                  Deployment

      the process of connecting to the websever running by web created by the developer and executing it   is said to be deploying 

      Initially we create service as v1 and with upgradation we release v2


      => we have 3 replicas for v1 and this 3 pods of v1 shold be replaced by 3 pods of v2 with  0  downtime for this we use rollback and rollout algorithm

      Rollout  ( v1 -> v2 -> v3 )   Rollback ( v1 <- v2 <- v3 )

      Ramped  ->  is is also called as  rolling update

        this process works such a way that the pod that is not connected to any user will be terminated and launch newer version

        kubectl get deployments

        kubectl create deployment myd  --image=httpd


        the above deployment  creates pod , SVC , RC , and deploy

        kubectl delete deploy  myd



        mkdir /webcode   
        cd /webcode

        vim index.html

                first copy .....

        vim  Dockerfile

            FROM centos
            RUN yum install httpd net-tools  -y
            COPY index.html  /var/www/html

        podman build -t myweb:v1   /webcode
        podman tag myweb:v1   kanna02/myweb:v1
        podman login kanna02
          > password
        podman push  kanna02/myweb:v1

        kubectl create deployment myd --image=kanna02/myweb:v1

        kubectl get po    , deploy   , svc

        kubectl expose deploy myd --type=Nodeport  --port=80

        kubectl get svc

        minikube ip   ---> using this IP we can access the data with  the port shown in svc when exposed 

        vim index.html

            first copy ......
            second copy .....

        podman build -t kanna02/web:v2  /webcode
        podman push kanna02/web:v2

        whenever we run the command of rollout the pods start terminating and recreate one after another and meanwhile the server provides new data

kubectl set image  deploy/myd  myweb=kanna03/myweb:v1      --- this is the command to rollback

      if simultaneously we run the command   curl http://IP:port      we can see the updated data after a while when the rollback command executed


kubectl rollout undo deploy myd --to-revision=1

=>  deployment is just a strategy we have 5 strategies    
          1. Ramped  2. Recreate  3. Blue/Green   4. Canary  5. A/B testing

kubernetes  have only  two stategies of above  1. Ramped  or  Rolling Update   2. Recreate 

Deployment doesnot know how to launch  or replicate pods it create RS internally and that Rs launch  and replicate POD


Secret Box   or  secret Data Base

        kubectl get secret

        kubectl get secret

        kubectl create secret generic mysecret --from-literal=p=redhat   --from-literal=u=kanna
        kubectl get secret 
        kubectl describe secret mysecret

        PVC  ->  DB image  -> SVC -> POD


        Kustomization    file create the above sequence at once instead  creating  one resource  after  another  manually 

        download mysql_deploymet.yaml   and  wordpress_deploymet.yaml     from 

                https://kubernetes.io/docs/tutorials/stateful-application/mysql-wordpress-persistent-volume/

        kustomization.yml

              apiVersion: configuration.k8s.io/v1beta1      or   kustomize.config.k8s.io/v1beta1
              kind: Kustomization
              SecretGenerator:
              - name: mysql_pass
                literals:
                - password=redhat
              resources:   
                - mysql_deploymet.yaml
                - word[ress_deployment.yaml


        kubectl delete all --all

        go to the folder in which we have kustomization file  

        kubectl create -K  .
        kubectl get svc   ,  rs  , pods  , secrets  , pvc 

        minikube ip

        in browser   IP:<port of wordpress >

          signUp  login  and publish  a line  


          delete the pod  of wordpress the wordpress exists

          
        
        

        
